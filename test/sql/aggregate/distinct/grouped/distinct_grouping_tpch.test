# name: test/sql/aggregate/distinct/grouped/distinct_grouping_tpch.test_slow
# group: [grouped]

require tpch

require ram 8gb

require disk_space 40gb

statement ok
pragma enable_verification

statement ok
pragma verify_parallelism

statement ok
PRAGMA verify_external

statement ok
CALL dbgen(sf=16);

statement ok
SELECT
	COUNT(DISTINCT l_orderkey),
	COUNT(DISTINCT l_partkey),
	COUNT(*),
	MIN(l_orderkey),
	MAX(l_orderkey),
	MIN(l_partkey),
	MAX(l_partkey),
	SUM(distinct_comment),
	AVG(distinct_comment)
FROM (
	select
		l_orderkey,
		l_partkey,
		count(distinct l_comment) AS distinct_comment
	from lineitem
	group by cube(l_orderkey, l_partkey)
);
